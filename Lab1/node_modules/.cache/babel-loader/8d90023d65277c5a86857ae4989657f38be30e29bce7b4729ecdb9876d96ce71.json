{"ast":null,"code":"/**\n * Module dependencies.\n */\n\nvar fs = require('fs');\nvar parallel = require('array-parallel');\n\n/**\n * Extend proto.\n */\n\nmodule.exports = function (proto) {\n  /**\n   * Do nothing.\n   */\n\n  function noop() {}\n\n  // http://www.graphicsmagick.org/GraphicsMagick.html#details-morph\n  proto.morph = function morph(other, outname, callback) {\n    if (!outname) {\n      throw new Error(\"an output filename is required\");\n    }\n    callback = (callback || noop).bind(this);\n    var self = this;\n    if (Array.isArray(other)) {\n      other.forEach(function (img) {\n        self.out(img);\n      });\n      self.out(\"-morph\", other.length);\n    } else {\n      self.out(other, \"-morph\", 1);\n    }\n    self.write(outname, function (err, stdout, stderr, cmd) {\n      if (err) return callback(err, stdout, stderr, cmd);\n\n      // Apparently some platforms create the following temporary files.\n      // Check if the output file exists, if it doesn't, then\n      // work with temporary files.\n      fs.exists(outname, function (exists) {\n        if (exists) return callback(null, stdout, stderr, cmd);\n        parallel([fs.unlink.bind(fs, outname + '.0'), fs.unlink.bind(fs, outname + '.2'), fs.rename.bind(fs, outname + '.1', outname)], function (err) {\n          callback(err, stdout, stderr, cmd);\n        });\n      });\n    });\n    return self;\n  };\n};","map":{"version":3,"names":["fs","require","parallel","module","exports","proto","noop","morph","other","outname","callback","Error","bind","self","Array","isArray","forEach","img","out","length","write","err","stdout","stderr","cmd","exists","unlink","rename"],"sources":["/home/redundunt/WebstormProjects/untitled/node_modules/gm/lib/convenience/morph.js"],"sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar fs = require('fs');\nvar parallel = require('array-parallel');\n\n/**\n * Extend proto.\n */\n\nmodule.exports = function (proto) {\n\n  /**\n   * Do nothing.\n   */\n\n  function noop () {}\n\n  // http://www.graphicsmagick.org/GraphicsMagick.html#details-morph\n  proto.morph = function morph (other, outname, callback) {\n    if (!outname) {\n      throw new Error(\"an output filename is required\");\n    }\n\n    callback = (callback || noop).bind(this)\n\n    var self = this;\n\n    if (Array.isArray(other)) {\n      other.forEach(function (img) {\n        self.out(img);\n      });\n      self.out(\"-morph\", other.length);\n    } else {\n      self.out(other, \"-morph\", 1);\n    }\n\n    self.write(outname, function (err, stdout, stderr, cmd) {\n      if (err) return callback(err, stdout, stderr, cmd);\n\n      // Apparently some platforms create the following temporary files.\n      // Check if the output file exists, if it doesn't, then\n      // work with temporary files.\n      fs.exists(outname, function (exists) {\n        if (exists) return callback(null, stdout, stderr, cmd);\n\n        parallel([\n          fs.unlink.bind(fs, outname + '.0'),\n          fs.unlink.bind(fs, outname + '.2'),\n          fs.rename.bind(fs, outname + '.1', outname)\n        ], function (err) {\n          callback(err, stdout, stderr, cmd);\n        })\n      })\n    });\n\n    return self;\n  }\n}\n"],"mappings":"AACA;AACA;AACA;;AAEA,IAAIA,EAAE,GAAGC,OAAO,CAAC,IAAI,CAAC;AACtB,IAAIC,QAAQ,GAAGD,OAAO,CAAC,gBAAgB,CAAC;;AAExC;AACA;AACA;;AAEAE,MAAM,CAACC,OAAO,GAAG,UAAUC,KAAK,EAAE;EAEhC;AACF;AACA;;EAEE,SAASC,IAAIA,CAAA,EAAI,CAAC;;EAElB;EACAD,KAAK,CAACE,KAAK,GAAG,SAASA,KAAKA,CAAEC,KAAK,EAAEC,OAAO,EAAEC,QAAQ,EAAE;IACtD,IAAI,CAACD,OAAO,EAAE;MACZ,MAAM,IAAIE,KAAK,CAAC,gCAAgC,CAAC;IACnD;IAEAD,QAAQ,GAAG,CAACA,QAAQ,IAAIJ,IAAI,EAAEM,IAAI,CAAC,IAAI,CAAC;IAExC,IAAIC,IAAI,GAAG,IAAI;IAEf,IAAIC,KAAK,CAACC,OAAO,CAACP,KAAK,CAAC,EAAE;MACxBA,KAAK,CAACQ,OAAO,CAAC,UAAUC,GAAG,EAAE;QAC3BJ,IAAI,CAACK,GAAG,CAACD,GAAG,CAAC;MACf,CAAC,CAAC;MACFJ,IAAI,CAACK,GAAG,CAAC,QAAQ,EAAEV,KAAK,CAACW,MAAM,CAAC;IAClC,CAAC,MAAM;MACLN,IAAI,CAACK,GAAG,CAACV,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;IAC9B;IAEAK,IAAI,CAACO,KAAK,CAACX,OAAO,EAAE,UAAUY,GAAG,EAAEC,MAAM,EAAEC,MAAM,EAAEC,GAAG,EAAE;MACtD,IAAIH,GAAG,EAAE,OAAOX,QAAQ,CAACW,GAAG,EAAEC,MAAM,EAAEC,MAAM,EAAEC,GAAG,CAAC;;MAElD;MACA;MACA;MACAxB,EAAE,CAACyB,MAAM,CAAChB,OAAO,EAAE,UAAUgB,MAAM,EAAE;QACnC,IAAIA,MAAM,EAAE,OAAOf,QAAQ,CAAC,IAAI,EAAEY,MAAM,EAAEC,MAAM,EAAEC,GAAG,CAAC;QAEtDtB,QAAQ,CAAC,CACPF,EAAE,CAAC0B,MAAM,CAACd,IAAI,CAACZ,EAAE,EAAES,OAAO,GAAG,IAAI,CAAC,EAClCT,EAAE,CAAC0B,MAAM,CAACd,IAAI,CAACZ,EAAE,EAAES,OAAO,GAAG,IAAI,CAAC,EAClCT,EAAE,CAAC2B,MAAM,CAACf,IAAI,CAACZ,EAAE,EAAES,OAAO,GAAG,IAAI,EAAEA,OAAO,CAAC,CAC5C,EAAE,UAAUY,GAAG,EAAE;UAChBX,QAAQ,CAACW,GAAG,EAAEC,MAAM,EAAEC,MAAM,EAAEC,GAAG,CAAC;QACpC,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF,OAAOX,IAAI;EACb,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}