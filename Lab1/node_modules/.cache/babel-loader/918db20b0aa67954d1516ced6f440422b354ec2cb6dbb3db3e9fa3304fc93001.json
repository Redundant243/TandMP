{"ast":null,"code":"/**\n * Extend proto.\n */\n\nmodule.exports = function (proto) {\n  proto.thumb = function thumb(w, h, name, quality, align, progressive, callback, opts) {\n    var self = this,\n      args = Array.prototype.slice.call(arguments);\n    opts = args.pop();\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = '';\n    } else {\n      callback = args.pop();\n    }\n    w = args.shift();\n    h = args.shift();\n    name = args.shift();\n    quality = args.shift() || 63;\n    align = args.shift() || 'topleft';\n    var interlace = args.shift() ? 'Line' : 'None';\n    self.size(function (err, size) {\n      if (err) {\n        return callback.apply(self, arguments);\n      }\n      w = parseInt(w, 10);\n      h = parseInt(h, 10);\n      var w1, h1;\n      var xoffset = 0;\n      var yoffset = 0;\n      if (size.width < size.height) {\n        w1 = w;\n        h1 = Math.floor(size.height * (w / size.width));\n        if (h1 < h) {\n          w1 = Math.floor(w1 * ((h - h1) / h + 1));\n          h1 = h;\n        }\n      } else if (size.width > size.height) {\n        h1 = h;\n        w1 = Math.floor(size.width * (h / size.height));\n        if (w1 < w) {\n          h1 = Math.floor(h1 * ((w - w1) / w + 1));\n          w1 = w;\n        }\n      } else if (size.width == size.height) {\n        var bigger = w > h ? w : h;\n        w1 = bigger;\n        h1 = bigger;\n      }\n      if (align == 'center') {\n        if (w < w1) {\n          xoffset = (w1 - w) / 2;\n        }\n        if (h < h1) {\n          yoffset = (h1 - h) / 2;\n        }\n      }\n      self.quality(quality).in(\"-size\", w1 + \"x\" + h1).scale(w1, h1, opts).crop(w, h, xoffset, yoffset).interlace(interlace).noProfile().write(name, function () {\n        callback.apply(self, arguments);\n      });\n    });\n    return self;\n  };\n  proto.thumbExact = function () {\n    var self = this,\n      args = Array.prototype.slice.call(arguments);\n    args.push('!');\n    self.thumb.apply(self, args);\n  };\n};","map":{"version":3,"names":["module","exports","proto","thumb","w","h","name","quality","align","progressive","callback","opts","self","args","Array","prototype","slice","call","arguments","pop","shift","interlace","size","err","apply","parseInt","w1","h1","xoffset","yoffset","width","height","Math","floor","bigger","in","scale","crop","noProfile","write","thumbExact","push"],"sources":["/home/redundunt/WebstormProjects/untitled/node_modules/gm/lib/convenience/thumb.js"],"sourcesContent":["\n/**\n * Extend proto.\n */\n\nmodule.exports = function (proto) {\n\n  proto.thumb = function thumb (w, h, name, quality, align, progressive, callback, opts) {\n    var self = this,\n      args = Array.prototype.slice.call(arguments);\n\n    opts = args.pop();\n\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = '';\n    } else {\n      callback = args.pop();\n    }\n\n    w = args.shift();\n    h = args.shift();\n    name = args.shift();\n    quality = args.shift() || 63;\n    align = args.shift() || 'topleft';\n    var interlace = args.shift() ? 'Line' : 'None';\n\n    self.size(function (err, size) {\n      if (err) {\n        return callback.apply(self, arguments);\n      }\n\n      w = parseInt(w, 10);\n      h = parseInt(h, 10);\n\n      var w1, h1;\n      var xoffset = 0;\n      var yoffset = 0;\n\n      if (size.width < size.height) {\n        w1 = w;\n        h1 = Math.floor(size.height * (w/size.width));\n        if (h1 < h) {\n          w1 = Math.floor(w1 * (((h-h1)/h) + 1));\n          h1 = h;\n        }\n      } else if (size.width > size.height) {\n        h1 = h;\n        w1 = Math.floor(size.width * (h/size.height));\n        if (w1 < w) {\n          h1 = Math.floor(h1 * (((w-w1)/w) + 1));\n          w1 = w;\n        }\n      } else if (size.width == size.height) {\n        var bigger = (w>h?w:h);\n        w1 = bigger;\n        h1 = bigger;\n      }\n\n      if (align == 'center') {\n        if (w < w1) {\n          xoffset = (w1-w)/2;\n        }\n        if (h < h1) {\n          yoffset = (h1-h)/2;\n        }\n      }\n\n      self\n      .quality(quality)\n      .in(\"-size\", w1+\"x\"+h1)\n      .scale(w1, h1, opts)\n      .crop(w, h, xoffset, yoffset)\n      .interlace(interlace)\n      .noProfile()\n      .write(name, function () {\n        callback.apply(self, arguments);\n      });\n    });\n\n    return self;\n  };\n\n  proto.thumbExact = function () {\n    var self = this,\n      args = Array.prototype.slice.call(arguments);\n\n    args.push('!');\n\n    self.thumb.apply(self, args);\n  };\n};\n"],"mappings":"AACA;AACA;AACA;;AAEAA,MAAM,CAACC,OAAO,GAAG,UAAUC,KAAK,EAAE;EAEhCA,KAAK,CAACC,KAAK,GAAG,SAASA,KAAKA,CAAEC,CAAC,EAAEC,CAAC,EAAEC,IAAI,EAAEC,OAAO,EAAEC,KAAK,EAAEC,WAAW,EAAEC,QAAQ,EAAEC,IAAI,EAAE;IACrF,IAAIC,IAAI,GAAG,IAAI;MACbC,IAAI,GAAGC,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACC,SAAS,CAAC;IAE9CP,IAAI,GAAGE,IAAI,CAACM,GAAG,EAAE;IAEjB,IAAI,OAAOR,IAAI,KAAK,UAAU,EAAE;MAC9BD,QAAQ,GAAGC,IAAI;MACfA,IAAI,GAAG,EAAE;IACX,CAAC,MAAM;MACLD,QAAQ,GAAGG,IAAI,CAACM,GAAG,EAAE;IACvB;IAEAf,CAAC,GAAGS,IAAI,CAACO,KAAK,EAAE;IAChBf,CAAC,GAAGQ,IAAI,CAACO,KAAK,EAAE;IAChBd,IAAI,GAAGO,IAAI,CAACO,KAAK,EAAE;IACnBb,OAAO,GAAGM,IAAI,CAACO,KAAK,EAAE,IAAI,EAAE;IAC5BZ,KAAK,GAAGK,IAAI,CAACO,KAAK,EAAE,IAAI,SAAS;IACjC,IAAIC,SAAS,GAAGR,IAAI,CAACO,KAAK,EAAE,GAAG,MAAM,GAAG,MAAM;IAE9CR,IAAI,CAACU,IAAI,CAAC,UAAUC,GAAG,EAAED,IAAI,EAAE;MAC7B,IAAIC,GAAG,EAAE;QACP,OAAOb,QAAQ,CAACc,KAAK,CAACZ,IAAI,EAAEM,SAAS,CAAC;MACxC;MAEAd,CAAC,GAAGqB,QAAQ,CAACrB,CAAC,EAAE,EAAE,CAAC;MACnBC,CAAC,GAAGoB,QAAQ,CAACpB,CAAC,EAAE,EAAE,CAAC;MAEnB,IAAIqB,EAAE,EAAEC,EAAE;MACV,IAAIC,OAAO,GAAG,CAAC;MACf,IAAIC,OAAO,GAAG,CAAC;MAEf,IAAIP,IAAI,CAACQ,KAAK,GAAGR,IAAI,CAACS,MAAM,EAAE;QAC5BL,EAAE,GAAGtB,CAAC;QACNuB,EAAE,GAAGK,IAAI,CAACC,KAAK,CAACX,IAAI,CAACS,MAAM,IAAI3B,CAAC,GAACkB,IAAI,CAACQ,KAAK,CAAC,CAAC;QAC7C,IAAIH,EAAE,GAAGtB,CAAC,EAAE;UACVqB,EAAE,GAAGM,IAAI,CAACC,KAAK,CAACP,EAAE,IAAK,CAACrB,CAAC,GAACsB,EAAE,IAAEtB,CAAC,GAAI,CAAC,CAAC,CAAC;UACtCsB,EAAE,GAAGtB,CAAC;QACR;MACF,CAAC,MAAM,IAAIiB,IAAI,CAACQ,KAAK,GAAGR,IAAI,CAACS,MAAM,EAAE;QACnCJ,EAAE,GAAGtB,CAAC;QACNqB,EAAE,GAAGM,IAAI,CAACC,KAAK,CAACX,IAAI,CAACQ,KAAK,IAAIzB,CAAC,GAACiB,IAAI,CAACS,MAAM,CAAC,CAAC;QAC7C,IAAIL,EAAE,GAAGtB,CAAC,EAAE;UACVuB,EAAE,GAAGK,IAAI,CAACC,KAAK,CAACN,EAAE,IAAK,CAACvB,CAAC,GAACsB,EAAE,IAAEtB,CAAC,GAAI,CAAC,CAAC,CAAC;UACtCsB,EAAE,GAAGtB,CAAC;QACR;MACF,CAAC,MAAM,IAAIkB,IAAI,CAACQ,KAAK,IAAIR,IAAI,CAACS,MAAM,EAAE;QACpC,IAAIG,MAAM,GAAI9B,CAAC,GAACC,CAAC,GAACD,CAAC,GAACC,CAAE;QACtBqB,EAAE,GAAGQ,MAAM;QACXP,EAAE,GAAGO,MAAM;MACb;MAEA,IAAI1B,KAAK,IAAI,QAAQ,EAAE;QACrB,IAAIJ,CAAC,GAAGsB,EAAE,EAAE;UACVE,OAAO,GAAG,CAACF,EAAE,GAACtB,CAAC,IAAE,CAAC;QACpB;QACA,IAAIC,CAAC,GAAGsB,EAAE,EAAE;UACVE,OAAO,GAAG,CAACF,EAAE,GAACtB,CAAC,IAAE,CAAC;QACpB;MACF;MAEAO,IAAI,CACHL,OAAO,CAACA,OAAO,CAAC,CAChB4B,EAAE,CAAC,OAAO,EAAET,EAAE,GAAC,GAAG,GAACC,EAAE,CAAC,CACtBS,KAAK,CAACV,EAAE,EAAEC,EAAE,EAAEhB,IAAI,CAAC,CACnB0B,IAAI,CAACjC,CAAC,EAAEC,CAAC,EAAEuB,OAAO,EAAEC,OAAO,CAAC,CAC5BR,SAAS,CAACA,SAAS,CAAC,CACpBiB,SAAS,EAAE,CACXC,KAAK,CAACjC,IAAI,EAAE,YAAY;QACvBI,QAAQ,CAACc,KAAK,CAACZ,IAAI,EAAEM,SAAS,CAAC;MACjC,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF,OAAON,IAAI;EACb,CAAC;EAEDV,KAAK,CAACsC,UAAU,GAAG,YAAY;IAC7B,IAAI5B,IAAI,GAAG,IAAI;MACbC,IAAI,GAAGC,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACC,SAAS,CAAC;IAE9CL,IAAI,CAAC4B,IAAI,CAAC,GAAG,CAAC;IAEd7B,IAAI,CAACT,KAAK,CAACqB,KAAK,CAACZ,IAAI,EAAEC,IAAI,CAAC;EAC9B,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}