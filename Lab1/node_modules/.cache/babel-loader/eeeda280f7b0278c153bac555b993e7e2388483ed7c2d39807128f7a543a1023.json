{"ast":null,"code":"/**\n * Extend proto.\n */\n\nmodule.exports = function (proto) {\n  var exifTransforms = {\n    topleft: '',\n    topright: ['-flop'],\n    bottomright: ['-rotate', 180],\n    bottomleft: ['-flip'],\n    lefttop: ['-flip', '-rotate', 90],\n    righttop: ['-rotate', 90],\n    rightbottom: ['-flop', '-rotate', 90],\n    leftbottom: ['-rotate', 270]\n  };\n  proto.autoOrient = function autoOrient() {\n    // Always strip EXIF data since we can't\n    // change/edit it.\n\n    // imagemagick has a native -auto-orient option\n    // so does graphicsmagick, but in 1.3.18.\n    // nativeAutoOrient option enables this if you know you have >= 1.3.18\n    if (this._options.nativeAutoOrient || this._options.imageMagick) {\n      this.out('-auto-orient');\n      return this;\n    }\n    this.preprocessor(function (callback) {\n      this.orientation({\n        bufferStream: true\n      }, function (err, orientation) {\n        if (err) return callback(err);\n        var transforms = exifTransforms[orientation.toLowerCase()];\n        if (transforms) {\n          // remove any existing transforms that might conflict\n          var index = this._out.indexOf(transforms[0]);\n          if (~index) {\n            this._out.splice(index, transforms.length);\n          }\n\n          // repage to fix coordinates\n          this._out.unshift.apply(this._out, transforms.concat('-page', '+0+0'));\n        }\n        callback();\n      });\n    });\n    return this;\n  };\n};","map":{"version":3,"names":["module","exports","proto","exifTransforms","topleft","topright","bottomright","bottomleft","lefttop","righttop","rightbottom","leftbottom","autoOrient","_options","nativeAutoOrient","imageMagick","out","preprocessor","callback","orientation","bufferStream","err","transforms","toLowerCase","index","_out","indexOf","splice","length","unshift","apply","concat"],"sources":["/home/redundunt/WebstormProjects/untitled/node_modules/gm/lib/convenience/autoOrient.js"],"sourcesContent":["\n/**\n * Extend proto.\n */\n\nmodule.exports = function (proto) {\n\n  var exifTransforms = {\n      topleft:     ''\n    , topright:    ['-flop']\n    , bottomright: ['-rotate', 180]\n    , bottomleft:  ['-flip']\n    , lefttop:     ['-flip', '-rotate', 90]\n    , righttop:    ['-rotate', 90]\n    , rightbottom: ['-flop', '-rotate', 90]\n    , leftbottom:  ['-rotate', 270]\n  }\n\n  proto.autoOrient = function autoOrient () {\n    // Always strip EXIF data since we can't\n    // change/edit it.\n\n    // imagemagick has a native -auto-orient option\n    // so does graphicsmagick, but in 1.3.18.\n    // nativeAutoOrient option enables this if you know you have >= 1.3.18\n    if (this._options.nativeAutoOrient || this._options.imageMagick) {\n      this.out('-auto-orient');\n      return this;\n    }\n\n    this.preprocessor(function (callback) {\n      this.orientation({bufferStream: true}, function (err, orientation) {\n        if (err) return callback(err);\n\n        var transforms = exifTransforms[orientation.toLowerCase()];\n        if (transforms) {\n\n          // remove any existing transforms that might conflict\n          var index = this._out.indexOf(transforms[0]);\n          if (~index) {\n            this._out.splice(index, transforms.length);\n          }\n\n          // repage to fix coordinates\n          this._out.unshift.apply(this._out, transforms.concat('-page', '+0+0'));\n        }\n\n        callback();\n      });\n    });\n\n    return this;\n  }\n}\n"],"mappings":"AACA;AACA;AACA;;AAEAA,MAAM,CAACC,OAAO,GAAG,UAAUC,KAAK,EAAE;EAEhC,IAAIC,cAAc,GAAG;IACjBC,OAAO,EAAM,EAAE;IACfC,QAAQ,EAAK,CAAC,OAAO,CAAC;IACtBC,WAAW,EAAE,CAAC,SAAS,EAAE,GAAG,CAAC;IAC7BC,UAAU,EAAG,CAAC,OAAO,CAAC;IACtBC,OAAO,EAAM,CAAC,OAAO,EAAE,SAAS,EAAE,EAAE,CAAC;IACrCC,QAAQ,EAAK,CAAC,SAAS,EAAE,EAAE,CAAC;IAC5BC,WAAW,EAAE,CAAC,OAAO,EAAE,SAAS,EAAE,EAAE,CAAC;IACrCC,UAAU,EAAG,CAAC,SAAS,EAAE,GAAG;EAChC,CAAC;EAEDT,KAAK,CAACU,UAAU,GAAG,SAASA,UAAUA,CAAA,EAAI;IACxC;IACA;;IAEA;IACA;IACA;IACA,IAAI,IAAI,CAACC,QAAQ,CAACC,gBAAgB,IAAI,IAAI,CAACD,QAAQ,CAACE,WAAW,EAAE;MAC/D,IAAI,CAACC,GAAG,CAAC,cAAc,CAAC;MACxB,OAAO,IAAI;IACb;IAEA,IAAI,CAACC,YAAY,CAAC,UAAUC,QAAQ,EAAE;MACpC,IAAI,CAACC,WAAW,CAAC;QAACC,YAAY,EAAE;MAAI,CAAC,EAAE,UAAUC,GAAG,EAAEF,WAAW,EAAE;QACjE,IAAIE,GAAG,EAAE,OAAOH,QAAQ,CAACG,GAAG,CAAC;QAE7B,IAAIC,UAAU,GAAGnB,cAAc,CAACgB,WAAW,CAACI,WAAW,EAAE,CAAC;QAC1D,IAAID,UAAU,EAAE;UAEd;UACA,IAAIE,KAAK,GAAG,IAAI,CAACC,IAAI,CAACC,OAAO,CAACJ,UAAU,CAAC,CAAC,CAAC,CAAC;UAC5C,IAAI,CAACE,KAAK,EAAE;YACV,IAAI,CAACC,IAAI,CAACE,MAAM,CAACH,KAAK,EAAEF,UAAU,CAACM,MAAM,CAAC;UAC5C;;UAEA;UACA,IAAI,CAACH,IAAI,CAACI,OAAO,CAACC,KAAK,CAAC,IAAI,CAACL,IAAI,EAAEH,UAAU,CAACS,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;QACxE;QAEAb,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF,OAAO,IAAI;EACb,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}